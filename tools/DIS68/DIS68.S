   10 REM 
   20 REM * 6800 DIS-ASSEMBLER
   30 REM 
   40 DIM L(1000):L1=0:L9=0
   50 GOTO 100
   59 REM * IN IBYTE
   60 B=PEEK(A)
   65 A=A+1
   70 B1=INT(B/16)
   75 B2=B-B1*16
   80 RETURN 
  100 CLEAR 
  110 PRINT "*6800 DIS-ASSEMBLER"
  120 PRINT 
  130 INPUT ">START ADDR",S
  140 INPUT ">END   ADDR",E
  141 PRINT "PRINTER? (Y/N)"
  142 IF INKEY$="Y" THEN P=1:GOTO 150
  143 IF INKEY$<>"N" THEN GOTO 142
  144 P=0
  150 PRINT "* PASS-1 *"
  199 REM * 1-PASS
  200 A=S
  210 GOSUB 60
  220 ON B1+1 GOSUB 300,300,400,300,300,300,500,600
  230 ON B1-7 GOSUB 500,700,500,600,500,700,500,600
  240 IF A<E THEN GOTO 210
  250 GOTO 1000
  299 REM * IMPLIED
  300 RETURN 
  399 REM * RELATIVE
  400 GOSUB 60
  410 IF B>127 THEN L2=A+B-256
  415 IF B<128 THEN L2=A+B
  420 GOSUB 800
  430 B1=0:RETURN 
  499 REM * INDEX
  500 IF B=$8D THEN GOTO 400
  505 IF B=$8E THEN GOTO 600
  506 IF B=$CE THEN GOTO 600
  507 IF B=$8C THEN GOTO 600
  510 GOSUB 60
  520 B1=0:RETURN 
  599 REM * EXTEND
  600 GOSUB 60
  610 L2=B
  620 GOSUB 60
  630 L2=L2*256+B
  640 GOSUB 800
  650 B1=0:RETURN 
  699 REM * DIRECT
  700 GOSUB 60
  710 L2=B
  720 GOSUB 800
  730 B1=0:RETURN 
  799 REM * LABEL
  800 IF L1=0 THEN GOTO 900
  810 I=1
  820 IF L(I)=L2 THEN RETURN 
  830 I=I+1
  840 IF I<=L1 THEN GOTO 820
  899 REM * APPEND
  900 L1=L1+1
  910 L(L1)=L2
  915 PRINT HEX(L2)
  920 RETURN 
  999 REM * PASS-2
 1000 GOSUB 1300
 1001 PRINT "* PASS-2 *"
 1002 IF P THEN PRINT #,"* DIS-ASSEMBLER *"
 1003 IF P THEN PRINT #,"FROM";HEX(S)
 1004 PRINT "FROM";HEX(S)
 1010 A=S
 1090 L4=1
 1100 IF L(L4)=A THEN L4=L4+1:GOTO 1150
 1105 IF L4>L1 THEN GOTO 1140
 1110 IF L(L4)<A THEN L4=L4+1:GOTO 1100
 1140 A$="        ":GOTO 1160
 1150 L2=INT(A/256):GOSUB 10000
 1152 A$=O1$
 1154 L2=A-L2*256:GOSUB 10000
 1156 A$=A$+O1$+"    "
 1160 GOSUB 60
 1165 N$="":O$=""
 1170 ON B1+1 GOSUB 2000,2100,3000,2200
 1180 IF (B1>3)*(B1<8) THEN GOSUB 4000
 1190 IF B1>7 THEN GOSUB 5000
 1195 PRINT A$;N$,O$
 1200 IF P THEN PRINT #,A$;N$,O$
 1205 IF A<E THEN GOTO 1100
 1210 PRINT "LABEL LIST TO PRINTER? (Y-N)"
 1220 IF INKEY$="Y" THEN P=1:GOTO 1400
 1230 IF INKEY$<>"N" THEN GOTO 1220
 1240 P=0
 1250 GOTO 1400
 1260 RETURN 
 1300 PRINT "* SORT *"
 1310 L2=L1
 1320 FOR I=1 TO L2
 1330 IF L(I)>L(I+1) THEN T=L(I):L(I)=L(I+1):L(I+1)=T
 1340 NEXT I
 1350 L2=L2-1:IF L2>1 THEN GOTO 1320
 1360 RETURN
 1400 FOR I=1 TO L1 STEP 5
 1410 IF P THEN ? #,HEX(L(I));HEX(L(I+1));HEX(L(I+2));HEX(L(I+3));HEX(L(I+4))
 1415 PRINT HEX(L(I));HEX(L(I+1));HEX(L(I+2));HEX(L(I+3));HEX(L(I+4))
 1420 NEXT I
 1430 END 
 1999 REM * $0X
 2000 N$="???"
 2005 IF B=1 THEN N$="NOP"
 2010 IF B=6 THEN N$="TAP"
 2015 IF B=7 THEN N$="TPA"
 2020 IF B=8 THEN N$="INX"
 2025 IF B=9 THEN N$="DEX"
 2030 IF B=10 THEN N$="CLV"
 2035 IF B=11 THEN N$="SEV"
 2040 IF B=12 THEN N$="CLC"
 2045 IF B=13 THEN N$="SEC"
 2050 IF B=14 THEN N$="CLI"
 2055 IF B=15 THEN N$="SEI"
 2060 RETURN 
 2099 REM * $1X
 2100 N$="???"
 2105 IF B=17 THEN N$="CBA"
 2110 IF B=22 THEN N$="TAB"
 2115 IF B=23 THEN N$="TBA"
 2120 IF B=25 THEN N$="DAA"
 2125 IF B=27 THEN N$="ABA"
 2130 RETURN 
 2199 REM * $3X
 2200 N$="???"
 2210 IF B2=0 THEN N$="TSX"
 2215 IF B2=1 THEN N$="INS"
 2220 IF B2=2 THEN N$="PULA"
 2225 IF B2=3 THEN N$="PULB"
 2230 IF B2=4 THEN N$="DES"
 2235 IF B2=5 THEN N$="TXS"
 2240 IF B2=6 THEN N$="PSHA"
 2245 IF B2=7 THEN N$="PSHB"
 2250 IF B2=9 THEN N$="RTS"
 2255 IF B2=11 THEN N$="RTI"
 2260 IF B2=14 THEN N$="WAI"
 2265 IF B2=15 THEN N$="SWI"
 2270 RETURN 
 2999 REM * RELATIVE
 3000 N$="???"
 3010 IF B=$20 THEN N$="BRA"
 3015 IF B=$22 THEN N$="BHI"
 3020 IF B=$23 THEN N$="BLS"
 3025 IF B=$24 THEN N$="BCC"
 3030 IF B=$25 THEN N$="BCS"
 3035 IF B=$26 THEN N$="BNE"
 3040 IF B=$27 THEN N$="BEQ"
 3045 IF B=$28 THEN N$="BVC"
 3050 IF B=$29 THEN N$="BVS"
 3055 IF B=$2A THEN N$="BPL"
 3060 IF B=$2B THEN N$="BMI"
 3065 IF B=$2C THEN N$="BGE"
 3070 IF B=$2D THEN N$="BLT"
 3075 IF B=$2E THEN N$="BGT"
 3080 IF B=$2F THEN N$="BLE"
 3085 IF B=$8D THEN N$="BSR"
 3090 IF N$="???" THEN RETURN 
 3100 GOSUB 60
 3110 IF B>127 THEN B1=A+B-256
 3120 IF B<128 THEN B1=A+B
 3130 L2=INT(B1/256)
 3135 GOSUB 10000
 3140 O$=" $"+O1$
 3145 L2=B1-L2*256
 3150 GOSUB 10000
 3155 O$=O$+O1$
 3160 B1=0:RETURN 
 3999 REM * $4X-$7X
 4000 N$="???"
 4010 IF B2=1 THEN RETURN 
 4020 IF B2=2 THEN RETURN 
 4030 IF B2=5 THEN RETURN 
 4040 IF B2=11 THEN RETURN 
 4050 IF (B2=14)*(B1<6) THEN RETURN 
 4100 IF B2=0 THEN N$="NEG"
 4105 IF B2=3 THEN N$="COM"
 4110 IF B2=4 THEN N$="LSR"
 4115 IF B2=6 THEN N$="ROR"
 4120 IF B2=7 THEN N$="ASR"
 4125 IF B2=8 THEN N$="ASL"
 4130 IF B2=9 THEN N$="ROL"
 4135 IF B2=10 THEN N$="DEC"
 4140 IF B2=12 THEN N$="INC"
 4145 IF B2=13 THEN N$="TST"
 4150 IF B2=14 THEN N$="JMP"
 4155 IF B2=15 THEN N$="CLR"
 4200 IF B1=4 THEN N$=N$+"A":RETURN 
 4210 IF B1=5 THEN N$=N$+"B":RETURN 
 4220 IF B1<>6 THEN GOTO 4300
 4230 GOSUB 60
 4240 L2=B:GOSUB 10000
 4250 O$=" $"+O1$+",X":B1=0:RETURN 
 4300 GOSUB 60
 4310 L2=B:GOSUB 10000
 4320 O$=" $"+O1$
 4330 GOSUB 60
 4340 L2=B:GOSUB 10000
 4350 O$=O$+O1$
 4360 B1=0:RETURN 
 4999 REM * $8X-$FX
 5000 N$="???"
 5010 IF B2=3 THEN RETURN 
 5020 IF B=$87 THEN RETURN 
 5030 IF B=$C7 THEN RETURN 
 5040 IF B=$8D THEN GOTO 3000
 5050 IF B=$9D THEN RETURN 
 5060 IF B=$8F THEN RETURN 
 5070 IF (B1>11)*(B2=12) THEN RETURN 
 5080 IF (B1>11)*(B2=13) THEN RETURN 
 5090 IF B=$CF THEN RETURN 
 5100 IF B2=0 THEN N$="SUB"
 5105 IF B2=1 THEN N$="CMP"
 5110 IF B2=2 THEN N$="SBC"
 5115 IF B2=4 THEN N$="AND"
 5120 IF B2=5 THEN N$="BIT"
 5125 IF B2=6 THEN N$="LDA"
 5127 IF B2=7 THEN N$="STA"
 5130 IF B2=8 THEN N$="EOR"
 5135 IF B2=9 THEN N$="ADC"
 5140 IF B2=10 THEN N$="ORA"
 5145 IF B2=11 THEN N$="ADD"
 5150 IF B2=12 THEN N$="CPX"
 5155 IF B2=13 THEN N$="JSR"
 5160 IF B2=14 THEN N$="LD"
 5165 IF B2=15 THEN N$="ST"
 5200 IF (B2<12)*(B1<12) THEN N$=N$+"A"
 5210 IF (B2<12)*(B1>11) THEN N$=N$+"B"
 5220 IF (B2>13)*(B1<12) THEN N$=N$+"S"
 5230 IF (B2>13)*(B1>11) THEN N$=N$+"X"
 5240 IF (B=$CE)+(B=$8E)+(B=$8C) THEN GOTO 5800
 5300 ON B1-7 GOSUB 5400,5500,5600,5700,5400,5500,5600,5700
 5310 RETURN 
 5399 REM * #
 5400 GOSUB 60
 5410 L2=B:GOSUB 10000
 5420 O$="#$"+O1$
 5430 RETURN 
 5499 REM * DIRECT
 5500 GOSUB 60
 5510 L2=B:GOSUB 10000
 5520 O$=" $"+O1$
 5530 RETURN 
 5599 REM * INDEXED
 5600 GOSUB 60
 5610 L2=B:GOSUB 10000
 5620 O$=" $"+O1$+",X"
 5630 RETURN 
 5699 REM * EXTEND
 5700 GOSUB 60
 5710 L2=B:GOSUB 10000
 5720 O$=" $"+O1$
 5730 GOSUB 60
 5740 L2=B:GOSUB 10000
 5750 O$=O$+O1$
 5760 RETURN 
 5799 REM * #2BYTE
 5800 GOSUB 60
 5810 L2=B:GOSUB 10000
 5820 O$="#$"+O1$
 5830 GOSUB 60
 5840 L2=B:GOSUB 10000
 5850 O$=O$+O1$
 5860 RETURN 
 9999 REM * 10=>16 L2,O1$
10000 A1=INT(L2/16)
10010 A2=L2-A1*16
10020 IF A1>9 THEN A1=A1+7
10030 IF A2>9 THEN A2=A2+7
10040 O1$=CHR$(A1+$30)+CHR$(A2+$30)
10050 RETURN
