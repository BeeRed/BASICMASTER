LPTR	EQU		$00D6
LSAVE	EQU		$00D8
LTOP	EQU		$B000
LEND	EQU		$DFFF
BANKSEL	EQU		$EFD0
CHROUT	EQU		$F015
NMISET	EQU		$FFE6
NMICLR	EQU		$FFE9
*
		ORG		$e000
		JMP		INIT
		ORG		$e01b
		JMP		STORE1C
*
INIT	STX		LSAVE
		LDX		#LTOP
		STX		LPTR
		PSHB
		PSHA
		SEI
		LDAB	BANKSEL
		TBA
		ORA		#1
		STAA	BANKSEL
I01		CLR		0,X
		INX
		CPX		#LEND+1
		BNE		I01
		STAB	BANKSEL
		CLI
		PULA
		PULB
		LDX		LPTR
		RTS
STORE1C	STX		LSAVE
		LDX		LPTR
		CPX		#LEND
		BEQ		STOREE
		PSHB
		PSHA
		LDAB	BANKSEL
		TBA
		ORAA	#1
		SEI
		STAA	BANKSEL
		PULA
		STAA	0,X
		INX
		STX		LPTR
		STAB	BANKSEL
		CLI
		PULB
STOREE	LDX		LSAVE
		JMP		CHROUT
		END
